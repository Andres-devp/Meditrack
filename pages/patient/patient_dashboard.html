<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard del Paciente - Meditrack</title>
    <link rel="stylesheet" href="../../css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="icon" href="../../images/app-icon.png" type="image/png">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Barra lateral -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">MediTrack</div>
            </div>
            <nav class="sidebar-nav">
                <a href="patient_dashboard.html" class="sidebar-nav-item active">
                    <i class="fas fa-home"></i> Dashboard
                </a>
                <a href="medications.html" class="sidebar-nav-item">
                    <i class="fas fa-pills"></i> Medicamentos
                </a>
                <a href="appointments.html" class="sidebar-nav-item">
                    <i class="fas fa-calendar-check"></i> Citas
                </a>
                <a href="symptom_history.html" class="sidebar-nav-item">
                    <i class="fas fa-heart-pulse"></i> Síntomas
                </a>
                <a href="rewards.html" class="sidebar-nav-item">
                    <i class="fas fa-trophy"></i> Recompensas
                </a>
                <a href="patient_profile.html" class="sidebar-nav-item">
                    <i class="fas fa-user"></i> Perfil
                </a>
                <a href="#" id="logoutBtn" class="sidebar-nav-item">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                </a>
            </nav>
        </aside>

        <!-- Contenido principal -->
        <main class="main-content">
            <!-- Encabezado -->
            <header class="header">
                <div class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </div>
                <div class="header-title">Dashboard</div>
                <div class="header-actions">
                    <div class="notification-bell">
                        <i class="fas fa-bell"></i>
                        <span id="notificationCount" class="notification-badge">0</span>
                    </div>
                    <span id="patientName">Paciente</span>
                </div>
            </header>

            <!-- Área de contenido -->
            <div class="content-area">
                <div class="dashboard-header">
                    <h1>Bienvenido, <span id="patientNameHeader">Paciente</span></h1>
                    <p>Aquí puedes gestionar todos los aspectos de tu salud.</p>
                </div>
                
                <!-- Resumen de estado de salud -->
                <div class="health-status-summary">
                    <div class="health-status-item">
                        <div class="status-icon">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <div class="status-info">
                            <h3>Adherencia</h3>
                            <div class="status-value" id="adherenceSummary">0%</div>
                        </div>
                    </div>
                    <div class="health-status-item">
                        <div class="status-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="status-info">
                            <h3>Medicamentos</h3>
                            <div class="status-value" id="medicationCount">0</div>
                        </div>
                    </div>
                    <div class="health-status-item">
                        <div class="status-icon">
                            <i class="fas fa-calendar"></i>
                        </div>
                        <div class="status-info">
                            <h3>Próxima Cita</h3>
                            <div class="status-value" id="nextAppointment">No hay citas</div>
                        </div>
                    </div>
                    <div class="health-status-item">
                        <div class="status-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="status-info">
                            <h3>Nivel</h3>
                            <div class="status-value" id="levelSummary">Nivel 1</div>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-cards">
                    <!-- Tarjeta de Medicamentos -->
                    <div class="dashboard-card">
                        <div class="dashboard-card-title">
                            <i class="fas fa-pills"></i> Mis Medicamentos
                        </div>
                        <div id="medicationsReminders" class="dashboard-card-content">
                            <div class="empty-state">
                                <p>No tienes medicamentos registrados.</p>
                                <a href="add_medication.html" class="btn btn-primary mt-2">Añadir Medicamento</a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tarjeta de Citas -->
                    <div class="dashboard-card">
                        <div class="dashboard-card-title">
                            <i class="fas fa-calendar-check"></i> Próximas Citas
                        </div>
                        <div id="appointmentsReminders" class="dashboard-card-content">
                            <div class="empty-state">
                                <p>No tienes citas programadas.</p>
                                <a href="add_appointment.html" class="btn btn-primary mt-2">Añadir Cita</a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tarjeta de Síntomas -->
                    <div class="dashboard-card">
                        <div class="dashboard-card-title">
                            <i class="fas fa-heart-pulse"></i> Últimos Síntomas
                        </div>
                        <div id="recentSymptoms" class="dashboard-card-content">
                            <div class="empty-state">
                                <p>No has registrado ningún síntoma recientemente.</p>
                                <a href="log_symptom.html" class="btn btn-primary mt-2">Registrar Síntoma</a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tarjeta de Adherencia con gráfico -->
                    <div class="dashboard-card">
                        <div class="dashboard-card-title">
                            <i class="fas fa-chart-line"></i> Mi Adherencia
                        </div>
                        <div class="dashboard-card-content">
                            <div class="adherence-chart">
                                <div class="adherence-percentage" id="adherencePercentage">0%</div>
                                <p>Adherencia a la medicación en los últimos 7 días</p>
                            </div>
                            <div class="canvas-container">
                                <canvas id="adherenceChart"></canvas>
                            </div>
                            <a href="report.html" class="btn btn-outline mt-2">Ver Informe Completo</a>
                        </div>
                    </div>
                    
                    <!-- Tarjeta de Recompensas -->
                    <div class="dashboard-card">
                        <div class="dashboard-card-title">
                            <i class="fas fa-trophy"></i> Mis Recompensas
                        </div>
                        <div id="rewardsPreview" class="dashboard-card-content">
                            <div class="rewards-progress">
                                <div class="rewards-level">
                                    <span class="level-icon">1</span>
                                    <span class="level-name">Principiante en Salud</span>
                                </div>
                                <p>Puntos: <span id="userPoints">0</span></p>
                                <div class="progress-bar">
                                    <div class="progress" id="levelProgress" style="width: 0%;"></div>
                                </div>
                            </div>
                            <div id="badgesPreview" class="badges-preview">
                                <!-- Las insignias se cargarán dinámicamente aquí -->
                            </div>
                            <a href="rewards.html" class="btn btn-outline mt-2">Ver Todas mis Recompensas</a>
                        </div>
                    </div>
                    
                    <!-- Tarjeta de Acciones Rápidas -->
                    <div class="dashboard-card">
                        <div class="dashboard-card-title">
                            <i class="fas fa-bolt"></i> Acciones Rápidas
                        </div>
                        <div class="dashboard-card-content">
                            <div class="quick-actions">
                                <a href="add_medication.html" class="quick-action">
                                    <i class="fas fa-pills"></i>
                                    <span>Añadir Medicamento</span>
                                </a>
                                <a href="add_appointment.html" class="quick-action">
                                    <i class="fas fa-calendar-plus"></i>
                                    <span>Programar Cita</span>
                                </a>
                                <a href="log_symptom.html" class="quick-action">
                                    <i class="fas fa-clipboard-list"></i>
                                    <span>Registrar Síntoma</span>
                                </a>
                                <a href="report.html" class="quick-action">
                                    <i class="fas fa-file-pdf"></i>
                                    <span>Generar Informe</span>
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Consejo de salud del día -->
                    <div class="dashboard-card">
                        <div class="dashboard-card-title">
                            <i class="fas fa-lightbulb"></i> Consejo del Día
                        </div>
                        <div class="dashboard-card-content">
                            <div id="healthTip" class="health-tip">
                                <p>Recuerda beber al menos 8 vasos de agua al día para mantenerte bien hidratado y mejorar la función de tus órganos.</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Calendario de medicación semanal -->
                    <div class="dashboard-card">
                        <div class="dashboard-card-title">
                            <i class="fas fa-calendar-week"></i> Mi Semana
                        </div>
                        <div class="dashboard-card-content">
                            <div class="week-calendar" id="weekCalendar">
                                <!-- El calendario semanal se cargará dinámicamente aquí -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Barra de navegación inferior para móviles -->
        <nav class="bottom-nav">
            <div class="bottom-nav-items">
                <a href="patient_dashboard.html" class="bottom-nav-item active">
                    <i class="fas fa-home"></i>
                    <span>Inicio</span>
                </a>
                <a href="medications.html" class="bottom-nav-item">
                    <i class="fas fa-pills"></i>
                    <span>Medicamentos</span>
                </a>
                <a href="appointments.html" class="bottom-nav-item">
                    <i class="fas fa-calendar-check"></i>
                    <span>Citas</span>
                </a>
                <a href="symptom_history.html" class="bottom-nav-item">
                    <i class="fas fa-heart-pulse"></i>
                    <span>Síntomas</span>
                </a>
                <a href="more.html" class="bottom-nav-item">
                    <i class="fas fa-ellipsis-h"></i>
                    <span>Más</span>
                </a>
            </div>
        </nav>
    </div>

    <script src="../../js/app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar autenticación
            const currentUser = Meditrack.getCurrentUser();
            if (!currentUser || currentUser.userType !== 'patient') {
                window.location.href = '../auth/login.html';
                return;
            }
            
            // Mostrar nombre del paciente
            document.getElementById('patientName').textContent = currentUser.name;
            document.getElementById('patientNameHeader').textContent = currentUser.name;
            
            // Mostrar puntos del usuario
            document.getElementById('userPoints').textContent = currentUser.points || 0;
            
            // Toggle del menú móvil
            document.querySelector('.menu-toggle').addEventListener('click', function() {
                document.querySelector('.sidebar').classList.toggle('active');
            });
            
            // Calcular y mostrar progreso del nivel
            const userPoints = currentUser.points || 0;
            let nextLevelPoints = 100; // Puntos para el siguiente nivel
            let currentLevelPoints = 0; // Puntos del nivel actual
            
            const level = Meditrack.gamification.getLevel(userPoints);
            document.querySelector('.level-icon').textContent = level.level;
            document.querySelector('.level-name').textContent = level.name;
            document.getElementById('levelSummary').textContent = `Nivel ${level.level}`;
            
            // Determinar puntos necesarios para el siguiente nivel
            if (level.level === 1) {
                nextLevelPoints = 100;
                currentLevelPoints = 0;
            } else if (level.level === 2) {
                nextLevelPoints = 200;
                currentLevelPoints = 100;
            } else if (level.level === 3) {
                nextLevelPoints = 300;
                currentLevelPoints = 200;
            } else if (level.level === 4) {
                nextLevelPoints = 500;
                currentLevelPoints = 300;
            } else {
                // Nivel máximo
                nextLevelPoints = 500;
                currentLevelPoints = 500;
            }
            
            // Calcular porcentaje de progreso para el siguiente nivel
            let progressPercentage = 100;
            if (level.level < 5) { // Si no está en el nivel máximo
                progressPercentage = ((userPoints - currentLevelPoints) / (nextLevelPoints - currentLevelPoints)) * 100;
            }
            
            document.getElementById('levelProgress').style.width = `${progressPercentage}%`;
            
            // Cargar medicamentos pendientes
            loadPendingMedications();
            
            // Cargar próximas citas
            loadUpcomingAppointments();
            
            // Cargar síntomas recientes
            loadRecentSymptoms();
            
            // Calcular y mostrar adherencia
            const adherencePercentage = Meditrack.utils.calculateAdherence(7);
            document.getElementById('adherencePercentage').textContent = `${adherencePercentage}%`;
            document.getElementById('adherenceSummary').textContent = `${adherencePercentage}%`;
            
            // Cargar estadísticas de medicamentos
            loadMedicationStats();
            
            // Mostrar próxima cita
            displayNextAppointment();
            
            // Mostrar insignias
            displayBadges();
            
            // Inicializar gráfico de adherencia
            initAdherenceChart();
            
            // Generar calendario semanal
            generateWeekCalendar();
            
            // Configurar botón de cerrar sesión
            document.getElementById('logoutBtn').addEventListener('click', function(e) {
                e.preventDefault();
                Meditrack.logout();
            });
            
            // Funciones para cargar datos
            function loadPendingMedications() {
                const pendingMedications = Meditrack.medications.getPendingMedications();
                const medicationsContainer = document.getElementById('medicationsReminders');
                
                if (pendingMedications.length > 0) {
                    medicationsContainer.innerHTML = '';
                    
                    pendingMedications.forEach(med => {
                        const reminderElement = document.createElement('div');
                        reminderElement.className = 'reminder';
                        
                        let nextDoseTime = 'Hoy';
                        if (med.schedule && med.schedule.times && med.schedule.times.length > 0) {
                            nextDoseTime = `Hoy a las ${med.schedule.times[0]}`;
                        }
                        
                        reminderElement.innerHTML = `
                            <div class="reminder-icon">
                                <i class="fas fa-pills"></i>
                            </div>
                            <div class="reminder-content">
                                <h4>${med.name} - ${med.dose} ${med.form}</h4>
                                <p>Próxima dosis: ${nextDoseTime}</p>
                            </div>
                            <button class="btn btn-primary take-dose-btn" data-id="${med.id}">
                                Tomar
                            </button>
                        `;
                        
                        medicationsContainer.appendChild(reminderElement);
                    });
                    
                    // Agregar eventos a los botones de tomar dosis
                    document.querySelectorAll('.take-dose-btn').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const medicationId = this.getAttribute('data-id');
                            Meditrack.medications.takeDose(medicationId);
                            loadPendingMedications(); // Recargar lista
                            
                            // Recalcular y mostrar adherencia
                            const adherencePercentage = Meditrack.utils.calculateAdherence(7);
                            document.getElementById('adherencePercentage').textContent = `${adherencePercentage}%`;
                            document.getElementById('adherenceSummary').textContent = `${adherencePercentage}%`;
                            
                            // Actualizar puntos del usuario
                            const currentUser = Meditrack.getCurrentUser();
                            document.getElementById('userPoints').textContent = currentUser.points || 0;
                            
                            // Actualizar gráfico de adherencia
                            updateAdherenceChart();
                            
                            // Mostrar notificación
                            Meditrack.showNotification('Dosis registrada', {
                                body: '¡Bien hecho! Has registrado correctamente tu medicación.',
                                icon: '../../images/med-icon.png'
                            });
                        });
                    });
                    
                } else {
                    medicationsContainer.innerHTML = `
                        <div class="empty-state">
                            <p>No tienes medicamentos pendientes para hoy.</p>
                            <a href="add_medication.html" class="btn btn-primary mt-2">Añadir Medicamento</a>
                        </div>
                    `;
                }
            }
            
            function loadUpcomingAppointments() {
                const upcomingAppointments = Meditrack.appointments.getUpcoming();
                const appointmentsContainer = document.getElementById('appointmentsReminders');
                
                if (upcomingAppointments.length > 0) {
                    appointmentsContainer.innerHTML = '';
                    
                    // Mostrar solo las próximas 3 citas
                    const appointmentsToShow = upcomingAppointments.slice(0, 3);
                    
                    appointmentsToShow.forEach(apt => {
                        const appointmentDate = new Date(apt.date + 'T' + apt.time);
                        const today = new Date();
                        const tomorrow = new Date(today);
                        tomorrow.setDate(today.getDate() + 1);
                        
                        let isUrgent = false;
                        // Marcar como urgente si la cita es hoy o mañana
                        if (appointmentDate.toDateString() === today.toDateString() || 
                            appointmentDate.toDateString() === tomorrow.toDateString()) {
                            isUrgent = true;
                        }
                        
                        const reminderElement = document.createElement('div');
                        reminderElement.className = isUrgent ? 'reminder reminder-urgent' : 'reminder';
                        
                        const formattedDate = Meditrack.utils.formatDate(apt.date);
                        
                        reminderElement.innerHTML = `
                            <div class="reminder-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="reminder-content">
                                <h4>Dr. ${apt.doctorName} - ${apt.specialty}</h4>
                                <p>${formattedDate} a las ${apt.time}</p>
                                <p>${apt.location}</p>
                            </div>
                        `;
                        
                        appointmentsContainer.appendChild(reminderElement);
                    });
                    
                    if (upcomingAppointments.length > 3) {
                        const moreAppointmentsLink = document.createElement('a');
                        moreAppointmentsLink.href = 'appointments.html';
                        moreAppointmentsLink.className = 'btn btn-outline mt-2';
                        moreAppointmentsLink.textContent = 'Ver todas las citas';
                        appointmentsContainer.appendChild(moreAppointmentsLink);
                    }
                    
                } else {
                    appointmentsContainer.innerHTML = `
                        <div class="empty-state">
                            <p>No tienes citas programadas.</p>
                            <a href="add_appointment.html" class="btn btn-primary mt-2">Añadir Cita</a>
                        </div>
                    `;
                }
            }
            
            function loadRecentSymptoms() {
                const recentSymptoms = Meditrack.symptoms.getRecent(3); // Obtener solo 3 síntomas recientes
                const symptomsContainer = document.getElementById('recentSymptoms');
                
                if (recentSymptoms.length > 0) {
                    symptomsContainer.innerHTML = '';
                    
                    recentSymptoms.forEach(symptom => {
                        const symptomElement = document.createElement('div');
                        symptomElement.className = 'symptom-item';
                        
                        // Determinar clase de intensidad
                        let intensityClass = '';
                        let intensityText = '';
                        
                        if (symptom.intensity === 1) {
                            intensityClass = 'intensity-low';
                            intensityText = 'Leve';
                        } else if (symptom.intensity === 2) {
                            intensityClass = 'intensity-medium';
                            intensityText = 'Moderada';
                        } else if (symptom.intensity === 3) {
                            intensityClass = 'intensity-high';
                            intensityText = 'Severa';
                        }
                        
                        // Formatear fecha
                        const symptomDate = new Date(symptom.date);
                        const formattedDate = symptomDate.toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit' });
                        
                        symptomElement.innerHTML = `
                            <div class="symptom-info">
                                <span class="symptom-name">${symptom.name}</span>
                                <span class="symptom-date">${formattedDate}</span>
                            </div>
                            <span class="symptom-intensity ${intensityClass}">${intensityText}</span>
                        `;
                        
                        symptomsContainer.appendChild(symptomElement);
                    });
                    
                    const viewAllLink = document.createElement('a');
                    viewAllLink.href = 'symptom_history.html';
                    viewAllLink.className = 'btn btn-outline mt-2';
                    viewAllLink.textContent = 'Ver historial completo';
                    symptomsContainer.appendChild(viewAllLink);
                    
                } else {
                    symptomsContainer.innerHTML = `
                        <div class="empty-state">
                            <p>No has registrado ningún síntoma recientemente.</p>
                            <a href="log_symptom.html" class="btn btn-primary mt-2">Registrar Síntoma</a>
                        </div>
                    `;
                }
            }
            
            function loadMedicationStats() {
                const medications = Meditrack.medications.getAll();
                const activeCount = medications.filter(med => med.active).length;
                
                document.getElementById('medicationCount').textContent = activeCount;
                
                // Actualizar contador de notificaciones
                const pendingMedications = Meditrack.medications.getPendingMedications();
                document.getElementById('notificationCount').textContent = pendingMedications.length;
            }
            
            function displayNextAppointment() {
                const upcomingAppointments = Meditrack.appointments.getUpcoming();
                
                if (upcomingAppointments.length > 0) {
                    const nextAppointment = upcomingAppointments[0]; // El primer elemento es la próxima cita
                    const appointmentDate = new Date(nextAppointment.date);
                    const formattedDate = appointmentDate.toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit' });
                    
                    document.getElementById('nextAppointment').textContent = formattedDate;
                } else {
                    document.getElementById('nextAppointment').textContent = 'No hay citas';
                }
            }
            
            function displayBadges() {
                const badges = Meditrack.gamification.getBadges(currentUser);
                const badgesContainer = document.getElementById('badgesPreview');
                
                if (badges.length > 0) {
                    badgesContainer.innerHTML = '';
                    
                    // Mostrar solo hasta 3 insignias
                    const badgesToShow = badges.slice(0, 3);
                    
                    badgesToShow.forEach(badge => {
                        const badgeElement = document.createElement('div');
                        badgeElement.className = 'badge-item-small';
                        badgeElement.innerHTML = badge.icon;
                        badgeElement.title = badge.name;
                        
                        badgesContainer.appendChild(badgeElement);
                    });
                    
                    if (badges.length > 3) {
                        const moreBadgesElement = document.createElement('div');
                        moreBadgesElement.className = 'badge-item-small badge-more';
                        moreBadgesElement.textContent = `+${badges.length - 3}`;
                        badgesContainer.appendChild(moreBadgesElement);
                    }
                }
            }
            
            function initAdherenceChart() {
                const adherenceCanvas = document.getElementById('adherenceChart');
                
                // Obtener datos para los últimos 7 días
                const labels = [];
                const data = [];
                
                for (let i = 6; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    labels.push(date.toLocaleDateString('es-ES', { weekday: 'short' }));
                    
                    // Calcular adherencia para este día
                    const dailyAdherence = Math.floor(Math.random() * 40) + 60; // Simulado para la demo
                    data.push(dailyAdherence);
                }
                
                window.adherenceChart = new Chart(adherenceCanvas, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Adherencia diaria (%)',
                            data: data,
                            borderColor: '#4285f4',
                            backgroundColor: 'rgba(66, 133, 244, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                min: 0,
                                max: 100,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }
            
            function updateAdherenceChart() {
                // Actualizar datos del gráfico de adherencia
                // En una app real, esto obtendría los datos reales de adherencia
                const newData = [];
                for (let i = 0; i < 7; i++) {
                    const dailyAdherence = Math.floor(Math.random() * 40) + 60;
                    newData.push(dailyAdherence);
                }
                
                if (window.adherenceChart) {
                    window.adherenceChart.data.datasets[0].data = newData;
                    window.adherenceChart.update();
                }
            }
            
            function generateWeekCalendar() {
                const calendarContainer = document.getElementById('weekCalendar');
                const daysOfWeek = ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'];
                const today = new Date();
                const currentDay = today.getDay(); // 0-6 (Domingo-Sábado)
                
                calendarContainer.innerHTML = '';
                
                const weekView = document.createElement('div');
                weekView.className = 'week-days';
                
                // Generar 7 días, empezando por el domingo
                for (let i = 0; i < 7; i++) {
                    const dayDate = new Date(today);
                    dayDate.setDate(today.getDate() - currentDay + i);
                    
                    const dayElement = document.createElement('div');
                    dayElement.className = 'week-day';
                    if (i === currentDay) {
                        dayElement.classList.add('today');
                    }
                    
                    const formattedDay = dayDate.getDate();
                    
                    // Verificar si hay medicamentos o citas para este día
                    const hasMedication = Math.random() > 0.5; // Simulado
                    const hasAppointment = Math.random() > 0.7; // Simulado
                    
                    dayElement.innerHTML = `
                        <div class="day-name">${daysOfWeek[i]}</div>
                        <div class="day-number">${formattedDay}</div>
                        <div class="day-indicators">
                            ${hasMedication ? '<span class="day-indicator medication"><i class="fas fa-pills"></i></span>' : ''}
                            ${hasAppointment ? '<span class="day-indicator appointment"><i class="fas fa-calendar-check"></i></span>' : ''}
                        </div>
                    `;
                    
                    weekView.appendChild(dayElement);
                }
                
                calendarContainer.appendChild(weekView);
            }
        });
    </script>
</body>
</html> 